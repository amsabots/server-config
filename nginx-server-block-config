server {
   listen 80;
   listen [::]:80;
    listen 443 ssl;
    listen [::]:443 ssl;

    server_name portal.madali.co.ke www.portal.madali.co.ke;
    
    if ($http_x_forwarded_proto = "http") {
      return 301 https://$server_name$request_uri;
         }   

    index index.html index.htm index.nginx-debian.html;

    ssl_certificate           /etc/nginx/ssl/portal.pem;
    ssl_certificate_key       /etc/nginx/ssl/portal-key.key;

    ssl_session_cache shared:SSL:1m;
    ssl_session_timeout  10m;

    ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers         HIGH:!aNULL:!MD5;

    access_log /var/log/nginx/access.log;
    error_log /var/log/nginx/error.log;

    location / {
     proxy_pass  http://localhost:24600;
     proxy_set_header X-Forwarded-Proto $scheme;
    } 
 }
